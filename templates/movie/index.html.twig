{% extends 'base.html.twig' %}

{% block javascripts %} 
   <script language = "javascript">  
      $(document).ready(function(){   
         $(".category-item").on("click", function(event){  
            // recupérer l'id de la cat
            $.ajax({  
               url:        '/',  
               type:       'POST',   
               dataType:   'json',  
               async:      true,  
               
               success: function(data, status) {              
                  for(i = 0; i < data.length; i++) {  
                     movie = data[i];  
                     var e = $('
                        <li class="card">
                            <div class="card-body">
                                <img id="poster" src="">
                                <h5 class="card-title">
                                    <p></p>
                                </h5>
                            </div>
                        </li>
                    ');
                     
                     $('#poster', e).attr('src', "https://image.tmdb.org/t/p/w200/" + movie['poster_path']);  
                     $('.card-title p', e).html(movie['title']);   
                     $('.filtered-movies').append(e);  
                  }  
               },  
               error : function(xhr, textStatus, errorThrown) {  
                  alert('Ajax request failed.');  
               }  
            });  
         });  
      });  
   </script> 
{% endblock %} 

{% block body %}
    {% block index_stylesheet %}{% endblock %}
    <div class="row"  >
        <div  class="col-lg-6" class="col-md-6" class="col-xs-12" class="col-sm-12" >
            <div id="suggestion">
                <h2>Discover</h2>
                <ul>
                    {% for movie in movies %}
                        <div class="card" >
                            <div class="card-body">
                                <img src="https://image.tmdb.org/t/p/w200/{{movie.poster_path}}" >
                                <h5 class="card-title">
                                    <p> {{ movie.title }} </p>
                                </h5>
                                <a class="btn btn-primary" href="{{ path('movie_show',{id:movie.id,name:movie.title}) }}"> Detail </a>
                            </div>
                        </div>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="col-lg-6" class="col-md-6" class="col-xs-12" class="col-sm-12" >
            <h2> fil d'actualité </h2>
            {% if listCommentFriend|length == 0 %}
                <p>Ajouter des Amis pour voirs leurs commentaires récents.</p>
            {% endif %}
            {%for comment in listCommentFriend %}
                    <div>{{comment.createdAt|date('d/m/y - H:i')}} <a href="{{ path('user_show',{id:comment.user.id} )}}" > {{comment.user.email}}</a>=><a href="{{ path('movie_show',{id:comment.movieId,name:'movie'}) }}">movie</a>: {{comment.text}} </div>
            {% endfor %}
        </div>
    </div>
    {% block javascript %}{% endblock %}
{% endblock %}

{% block index_stylesheet %}
    <style>
        #research-menu {
            background-color: #e95325;
            color: #fff;
            text-align:center;
            width: 250px;
        }
        #research-menu label {
            cursor:pointer;
        }
        /* le bloc n'est pas visible lorsque la checkbox n'est pas cochée */
        #category-block {
            max-height: 0px;
            opacity: 0;
            line-height:100px;
            border: 1px dotted #fff;
            margin:2px;
            transition: all 1s;
        }
        
        /* le bloc est visible lorsque la checkbox est cochée */
        #toggle-block:checked + #category-block{
            max-height: 300px;
            opacity: 1;
            transition: all 1s;
        }
    </style>
{% endblock %}
